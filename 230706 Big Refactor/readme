I forgot to make a sanity check and decided to refactor everything, all at once.
